<!doctype html>

<!--  -->
{% if type == 'Engineering Talent'%}
<!--  -->
{% extends 'talent/layout.html' %}
<!--  -->
{% else %}
<!--  -->
{% extends 'pm/layout.html' %}
<!--  -->
{% endif %}
<!--  -->
{% block content %}

<script>
    document.addEventListener("DOMContentLoaded", function(event) {

        fetch('{{ url_for("contacts") }}', {
            method: "POST",
        })

        // var slides = ["slide 1", "slide 2", "slide 3", "slide 4", "slide 5"]
        // var str = '<ul>'
        // slides.forEach(function(slide) {
        //     str += '<li>' + slide + '</li>';
        // });
        // str += '</ul>';

        // document.getElementById("skillContainer").innerHTML = str;

    });
</script>


<!-- App Header -->
<div class="appHeader bg-primary text-light">
    <div class="left">
        <a href="#" class="headerButton goBack">
            <ion-icon name="chevron-back-outline"></ion-icon>
        </a>
    </div>
    <div class="pageTitle">My Profile</div>
    <div class="right">
        {% if type != user.data.account.usertype %}
        <a href="#" class="headerButton">
            <ion-icon name="bookmark-outline"></ion-icon>
        </a>
        <form action="{{ url_for('new_contact') }}" method="POST">
            <input hidden type="email" class="form-control" name="email" id="email" value="{{user.data.account.email}}">
            <button type="input" class="headerButton" style="background: transparent !important; border-width: 0px !important;">
                <ion-icon name="person-add-outline"></ion-icon>            
            </button>
        </form>
        <!--  -->
        {% endif %}
    </div>
</div>
<!-- * App Header -->

<!-- App Capsule -->
<div id="appCapsule">

    <div class="section mt-2">
        <h4>About
            <a href="{{ url_for('profile_edit') }}">
                <ion-icon name="add-circle-outline"></ion-icon>
            </a>
        </h4>
        <div class="profile-head">
            <div class="avatar">
                <img src="{{user.data.profile.photo}}" alt="avatar" class="imaged w64 rounded">
            </div>
            <div class="in">
                <h3 class="name" style="margin-bottom:0px">{{user.data.account.firstname}} {{user.data.account.lastname}}</h3>
                <div class="profile-info" style="margin-top:0px">
                    <div class="link" style="margin-top:0px">{{user.data.profile.headline}}</div>
                </div>
                <h5 class="subtext">{{user.data.profile.city}}, {{user.data.profile.zipcode}}</h5>
            </div>
        </div>
    </div>

    <div class="section mt-1 mb-2">
        <div class="row">
            <div class="col-9 m-0">
                <div class="profile-info m-0">
                    <div class="bio m-0">
                        {{user.data.profile.summary}}
                    </div>
                </div>
            </div>
            <div class="col-3">
                <div class="section">
                    <div class="row" style="width: 80px;">
                        <div class="col">
                            <div class="circle-progress-container">
                                <div id="progress1">
                                    <div class="inner">
                                        <p class="mt-2">{{user.data.profile.availability}} hrs.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- <p class="mt-2">Availability</p> -->
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="section full">
        <div class="wide-block transparent p-0">
            <ul class="nav nav-tabs lined iconed" role="tablist">
                <li class="nav-item">
                    <a class="nav-link " data-bs-toggle="tab" href="#experience" role="tab">
                        <ion-icon name="id-card-outline"></ion-icon>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#education" role="tab">
                        <ion-icon name="library-outline"></ion-icon>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#skills" role="tab">
                        <ion-icon name="flask-outline"></ion-icon>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#contacts" role="tab">
                        <ion-icon name="people-outline"></ion-icon>
                    </a>
                </li>
            </ul>
        </div>
    </div>


    <!-- tab content -->
    <div class="section full mb-2">
        <div class="tab-content">

            <!-- experience -->
            <div class="tab-pane fade " id="experience" role="tabpanel">
                <div class="section m-2">


                    <h4>Experience
                        <a href="{{ url_for('experience_edit') }}">
                            <ion-icon name="add-circle-outline"></ion-icon>
                        </a>
                    </h4>


                    <ul class="listview image-listview media flush transparent" style="margin-left: 0px;">
                        {% for exp_id in user["data"]["experience"] %}
                        <li>
                            <a href="{{ url_for('experience_edit', experience_id = exp_id) }}" class="item">
                                <div class="imageWrapper" style="margin-left:-15px;">
                                    <!-- <img src="../static/assets/img/sample/photo/1.jpg" alt="image" class="imaged w64"> -->
                                    <ion-icon style="font-size:40px; --ionicon-stroke-width:15px; color:#1E74FD" name="id-card-outline"></ion-icon>
                                </div>
                                <div class="in">
                                    <div>
                                        {{user["data"]["experience"][exp_id]["company"]}}
                                        <div class="text-muted">{{user["data"]["experience"][exp_id]["title"]}}</div>
                                        <div class="text-muted">
                                            {{user["data"]["experience"][exp_id]["start"]}} - {{user["data"]["experience"][exp_id]["end"]}}
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <!--  -->
                        {% endfor %}
                    </ul>

                </div>



            </div>
            <!-- * experience -->



            <!--  education -->
            <div class="tab-pane fade" id="education" role="tabpanel">
                <div class="section m-2">
                    <h4>Education
                        <a href="{{ url_for('education_edit') }}">
                            <ion-icon name="add-circle-outline"></ion-icon>
                        </a>
                    </h4>
                    <ul class="listview image-listview media flush transparent mt-1 mb-1">
                        {% for edu_id in user["data"]["education"] %}
                        <li class="mt-0 mb-0">
                            <a href="{{ url_for('education_edit', education_id = edu_id) }}" class="item">
                                <div class="imageWrapper" style="margin-left:-15px;">
                                    <!-- <img src="../static/assets/img/sample/photo/1.jpg" alt="image" class="imaged w64"> -->
                                    <ion-icon style="font-size:40px; --ionicon-stroke-width:15px; color:#1E74FD" name="library-outline"></ion-icon>
                                </div>
                                <div class="in">
                                    <div>
                                        {{user["data"]["education"][edu_id]["school"]}}
                                        <div class="text-muted">{{user["data"]["education"][edu_id]["field"]}}</div>
                                        <div class="text-muted">{{user["data"]["education"][edu_id]["degree"]}}</div>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <!--  -->
                        {% endfor %}
                    </ul>
                </div>
            </div>
            <!-- * education -->




            <!-- skills -->
            <div class="tab-pane fade show active" id="skills" role="tabpanel">

                <!-- <div class="section full m-1"> -->
                <div class="section m-2">

                    <ul class="nav nav-tabs capsuled" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#skillz" role="tab">
                                Skills
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#recommendations" role="tab">
                                Recommendations
                            </a>
                        </li>
                    </ul>


                    <script>
                        var skillsStr = ''
                        var skills = ["skill 1", "skill 2", "skill 3", "skill 4", "skill 5"]

                        document.addEventListener("DOMContentLoaded", function(event) {
                            //get the skill list through jinja or through post...
                            loadSkills(skills);
                        });


                        function loadSkills(skills) {
                            skills.forEach(function(skill) {
                                skillsStr += '<div class="chip chip-primary ms-05 mb-05"><span class="chip-label">' +
                                    skill +
                                    '</span><a href="#" class="chip-delete"><ion-icon name="close-circle"></ion-icon></a></div>';
                            });
                            document.getElementById("skillContainer").innerHTML = skillsStr;
                        }

                        function appendSkill() {
                            // 1. get value from form

                            // 2. add the value to the current list
                            skills.push(skill)

                            // 3. re-render the list with the new item
                            loadSkills(skills);

                            // 4. post to fauna
                            // post to fauna
                            // 
                        }
                    </script>



                    <div class="tab-content mt-2">

                        <!-- skillz -->
                        <div class="tab-pane fade show active" id="skillz" role="tabpanel">

                            <div class="section mt-2 mb-2">
                                <h4 class="mb-2">Skills
                                    <!-- <a href="#">
                                        <ion-icon name="add-circle-outline"></ion-icon>
                                    </a> -->
                                </h4>



                                <div id="skillContainer"></div>






                                <div class="chip chip-primary ms-05 mb-05">
                                    <span class="chip-label">Skill</span>
                                    <a href="#" class="chip-delete">
                                        <ion-icon name="close-circle"></ion-icon>
                                    </a>
                                </div>

                            </div>

                            <div class="section mt-2 mb-2">
                                <h4 class="mt-2 mb-2">Endorsed Skills</h4>


                                <div class="chip chip-primary chip-media ms-05 mb-05">
                                    <p class="chip-icon bg-success">1</p>
                                    <span class="chip-label">Endorsed Skill</span>
                                    <a href="#" class="chip-delete">
                                        <ion-icon name="close-circle"></ion-icon>
                                    </a>
                                </div>

                            </div>

                        </div>

                        <!-- *skillz -->

                        <!-- recommendations -->
                        <div class="tab-pane fade" id="recommendations" role="tabpanel">

                            <div class="error-page">
                                <div class="spinner-border text-primary mb-4" role="status"></div>
                                <h1 class="title">Coming Soon!</h1>
                                <div class="text mb-3">
                                    This content is under construction!
                                </div>
                            </div>
                            <!-- <ul class="listview image-listview flush transparent">
                                <li class="multi-level">
                                    <a href="#" class="item">
                                        <img src="../static/assets/img/sample/avatar/avatar1.jpg" alt="image" class="image">
                                        <div class="in">
                                            <div>Dave</div>
                                        </div>
                                    </a>
                                    <ul class="listview simple-listview transparent">
                                        <p>text</p>
                                    </ul>
                            </ul> -->

                        </div>
                        <!-- *recommendations -->

                    </div>

                </div>
                <!-- </div> -->


            </div>
            <!-- * skills -->

            <!-- * contacts -->
            <div class="tab-pane fade" id="contacts" role="tabpanel">
                <div class="section m-2">

                    <div class="row">
                        <div class="col-8">
                            <h4>Contacts
                                <a href="{{ url_for('contacts') }}">
                                    <ion-icon name="add-circle-outline"></ion-icon>
                                </a>
                            </h4>
                        </div>
                    </div>

                    <ul class="listview image-listview flush transparent">
                        {% for contact in contacts %}
                        <li>
                            <a href="{{ url_for('profile_details', email = contact.email) }}" class="item">
                                <img src="{{ contact.photo }}" alt="image" class="image">
                                <div class="in">
                                    <div>{{ contact.firstname }} {{ contact.lastname }}</div>
                                </div>
                            </a>
                        </li>
                        {% endfor %}

                    </ul>

                </div>
            </div>
            <!-- * contacts -->

        </div>
    </div>
    <!-- * tab content -->

</div>
<!-- * App Capsule -->

<script src="../static/assets/js/plugins/progressbar-js/progressbar.min.js"></script>

<script>
    // Availability
    var percent = 0;
    var hrs = 0;
    var availabilityVal = '{{ user.data.profile.availability }}';

    document.addEventListener("DOMContentLoaded", function(event) {

        if (availabilityVal) {
            hrs = availabilityVal;
            percent = hrs / 40;
        }

        var circleProgress1 = new ProgressBar.Circle(progress1, {
            strokeWidth: 8,
            easing: 'easeInOut',
            duration: 2400,
            color: '#1E74FD',
            trailColor: '#E5E5E5',
            trailWidth: 8,
            svgStyle: null
        });
        circleProgress1.animate(percent); // percent
    });
</script>


{% endblock %}